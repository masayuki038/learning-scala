# 序章

- 前章でScalaの基本を理解したので、Scalaですべての機能を持ったクラスをデザインする準備ができた
- この章の重点は、どんなmutableな状態も持たない関数オブジェクトを定義するクラスにある
- 例として、有理数をimmutableオブジェクトとしてモデリングするクラスのパターンをいくつか作成する
- この方法に沿って、クラスパラメータやコンストラクタ、メソッド、演算子、privateメンバ、オーバーライド、事前チェック、オーバーロード、そして自身への参照といった、Scalaのオブジェクト指向のより多くの側面を見ることができる

# 6.1 A specification for class Rational

- 有理数は、n/dで率を表現する数字であり、nとdは整数で、dは0以外になる
- nは分子、dは分母と呼ばれる
- 有理数の例は次のとおり: 1/2、2/3、112/239、2/1
- 浮動小数と比較すると、端数が有理数丸めや近似値を用いることなく正確な値で表現されるという利点がある
- この章でデザインするクラスは、加算、減算、積算、除算を含む有理数の振る舞いをモデル化する
- 2つの有理数を加算する場合、共通の分母を求めてから分子を加算する
- 積算は単純に分子と分母をそれぞれ掛けるだけ
- 除算は右項の分子と分母を逆転させて積算する
- 一つの観点としては、数学では有理数は状態を持たない
- 一つの有理数をもう一つの有理数と加算すると、結果は新しい有理数になる
- 元の数は変化しない
- この章でデザインするimmutableなRationalクラスは同じ性質を持つ
- それぞれの有理数は一つのRationalオブジェクトによって表現される
- 2つのRationalオブジェクトを加算すると、加算した値を持つ一つのRationalオブジェクトが生成される
- この章では、Scalaのネイティブな言語サポートであるかのようなライブラリを書くことができるのを垣間見るだろう

# 6.2 Constructing a Rational

- Rationalクラスのデザインを始める良い取っ掛かりは、クライアントプログラマにどのようにRationalオブジェクトを作ってもらうかを考えることだ
- Rationalオブジェクトはimmutableにすることにしたので、インスタンス生成時に、クライアントがインスタンスのすべてのデータを要求する
- それゆえ、以下のようになる

```scala
class Rational(n: Int, d: Int)
```

- 特筆するべき最初の点は、メソッドの中身が無ければ、空のカーリー括弧を指定する必要がない(付けたいと思えば付けることもできる)
- Rationalのクラス名の後のnとdは、クラスパラメータと呼ばれる
- Scalaコンパイラはこれらの2つのクラスパラメータを集約し、二つのパラメータを指定するプライマリコンストラクタを作成する
- このRationalの初期の例はJavaとScalaの違いを浮き彫りにする
- Javaでは、クラスはコンストラクタをを持つのに対して、Scalaはパラメータを直接取る
- Scalaの記法は、より短く書ける - クラスパラメータはクラスの本体に直接使用される
- フィールドを定義したり、フィールドに値を設定する為の記述が不要である
- これは、特に小さなクラスにおいて、お決まりのコードの記述を大幅に削減する
- Scalaコンパイラは、フィールドやメソッド以外の部分に記載されたコードをプライマリコンストラクタとしてコンパイルする

```scala
class Rational(n: Int, d: Int) {
  println("Created " + n + "/" + d)
}
```

- このコードにより、printlnの呼び出しはRationalのプライマリコンストラクタに配置する
- それゆえ、printlnの呼び出しは、Rationalインスタンスを構築する際にデバッグメッセージを出力する

# 6.3 Reimplementing the toString method

- 先の例で、Rationalオブジェクトを作成した時、"Rational@90110a"と表示された
- インタープリタはRationalオブジェクトのtoStringメソッドを呼び出した際、幾分奇妙な文字列を取得した
- デフォルトでは、Rationalクラスは、クラス名と@記号、そして16進数を出力するjava.lang.ObjectのtoStringの実装を継承している
- toStringの結果は、基本的にはデバッグやログメッセージ、テスト失敗のレポート、デバッガやインタープリタのアウトプットで使用可能な情報をプロジェクトに提供することを意図している
- toStringによって提供されるこの結果は、特別参考にならない、なぜなら、有理数の値について手がかりを提供しない為である
- より効果的なtoStringの実装は、有理数の分子と分母を表示することである
- RationalクラスのtoStringメソッドをオーバーライドすることができる

```scala
class Rational(n: Int, d: Int) {
  override def toString = n + "/" + d
}
```

- 先頭のoverride識別子は以前定義されたメソッド定義を上書きする、というシグナルである
- 有理数の表示が良くなったので、Rationalクラスに記述していたデバッグ出力のステートメントを削除した

```scala
scala> class Rational(n: Int, d: Int) {
     | override def toString = n +"/"+ d
     | }
defined class Rational

scala> val x = new Rational(1, 3)
x: Rational = 1/3

scala> val y = new Rational(5, 7)
y: Rational = 5/7
```

# 単語
- emphasis
    - 重点
    - 強調
    - 語勢
- rational
    - 理性的な
    - 合理的な
    - 冷静な
- rational number
    - 有理数
- approximation
    - 近似値
- numerator
    - 分子
- denominator
    - 分母
- fraction
    - 破片
    - 分数
    - 端数
- observation
    - 注目
    - 観察
    - 所見、見解
- substantial
    - 実体がある
    - 十分な
    - 相当な
- clue
    - 手がかり
    - 糸口